/* ======================================
   Visual Studio 2026 Mockup â€” Styles
   Matched to actual VS 2026 screenshots
   ====================================== */

:root {
  --bg-darkest:    #1e1e1e;
  --bg-dark:       #252526;
  --bg-medium:     #2d2d2d;
  --bg-light:      #333333;
  --bg-lighter:    #3c3c3c;
  --bg-hover:      #404040;
  --bg-active:     #094771;
  --bg-selected:   #04395e;
  --border:        #3f3f3f;
  --border-light:  #555;
  --text:          #cccccc;
  --text-bright:   #e0e0e0;
  --text-dim:      #999;
  --text-dimmer:   #666;
  --accent:        #0078d4;
  --accent-light:  #1a8fff;
  --green:         #4ec9b0;
  --yellow:        #dcdcaa;
  --orange:        #ce9178;
  --blue:          #569cd6;
  --light-blue:    #9cdcfe;
  --purple:        #c586c0;
  --red:           #f44747;
  --comment-green: #6a9955;
  --directive-color: #c586c0;
  --attr-color:    #92c5f7;
  --string-color:  #ce9178;
  --font-ui:       'Segoe UI', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
  --font-code:     'Cascadia Code', 'Fira Code', 'Consolas', 'Courier New', monospace;
  --radius:        4px;
  --radius-lg:     8px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: var(--font-ui);
  font-size: 13px;
  color: var(--text);
  background: var(--bg-darkest);
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  user-select: none;
}

/* Scrollbar */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.12); border-radius: 5px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.22); }

/* ============ TITLEBAR ============ */
.titlebar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 30px;
  background: var(--bg-lighter);
  border-bottom: 1px solid var(--border);
  padding: 0 8px;
  flex-shrink: 0;
}
.titlebar-left { display: flex; align-items: center; gap: 6px; }
.vs-icon { display: flex; align-items: center; }
.menu-bar { display: flex; gap: 2px; }
.menu-item {
  padding: 2px 8px; border-radius: var(--radius);
  cursor: pointer; font-size: 12px; color: var(--text);
}
.menu-item:hover { background: var(--bg-hover); }

.titlebar-center { flex: 1; display: flex; align-items: center; justify-content: center; gap: 12px; }
.search-box {
  display: flex; align-items: center; gap: 6px;
  background: var(--bg-dark); border: 1px solid var(--border);
  border-radius: 6px; padding: 2px 12px;
  width: 260px; height: 22px; font-size: 12px; color: var(--text-dim); cursor: text;
}
.titlebar-project-name { font-weight: 600; color: var(--text-bright); font-size: 12px; }

.titlebar-right { display: flex; align-items: center; gap: 6px; }
.user-avatar-circle {
  width: 22px; height: 22px; border-radius: 50%;
  background: var(--bg-hover); display: flex; align-items: center; justify-content: center;
  border: 1.5px solid #7c4dff;
}
.window-controls { display: flex; margin-left: 8px; }
.win-btn {
  width: 30px; height: 30px; background: none; border: none;
  color: var(--text); cursor: pointer; display: flex;
  align-items: center; justify-content: center; font-size: 12px;
}
.win-btn:hover { background: var(--bg-hover); }
.win-btn.close:hover { background: #e81123; color: #fff; }

/* ============ TOOLBAR ============ */
.toolbar {
  display: flex; align-items: center; height: 32px;
  background: var(--bg-medium); border-bottom: 1px solid var(--border);
  padding: 0 6px; gap: 4px; flex-shrink: 0;
}
.toolbar-group { display: flex; align-items: center; gap: 2px; }
.toolbar-right-icons { margin-left: auto; }
.toolbar-sep { width: 1px; height: 18px; background: var(--border); margin: 0 4px; }
.tool-btn {
  background: none; border: none; color: var(--text-dim); cursor: pointer;
  padding: 3px 4px; border-radius: var(--radius); font-size: 13px;
}
.tool-btn:hover { background: var(--bg-hover); color: var(--text); }
.toolbar-select {
  background: var(--bg-dark); border: 1px solid var(--border); color: var(--text);
  padding: 2px 6px; border-radius: var(--radius); font-size: 12px; font-family: var(--font-ui); cursor: pointer;
}
.config-select { min-width: 70px; }
.run-btn {
  display: flex; align-items: center; gap: 4px;
  background: #2ea043; border: none; color: #fff;
  padding: 3px 10px; border-radius: var(--radius) 0 0 var(--radius);
  cursor: pointer; font-size: 12px; font-family: var(--font-ui); font-weight: 600;
}
.run-btn:hover { background: #26863a; }
.run-dropdown {
  background: #2ea043; color: #fff; border-radius: 0 var(--radius) var(--radius) 0;
  border-left: 1px solid rgba(255,255,255,0.2); font-size: 10px; padding: 3px 4px;
}
.run-dropdown:hover { background: #26863a; color: #fff; }
.play-icon { font-size: 10px; }
.toolbar-label { font-size: 12px; color: var(--text-dim); padding: 0 4px; font-weight: 600; }
.copilot-badge-toolbar { display: flex; align-items: center; }
.vs-version { font-size: 11px; color: var(--text-dim); margin-left: 4px; font-weight: 600; }

/* ============ MAIN CONTAINER ============ */
.main-container { display: flex; flex: 1; overflow: hidden; }

/* ============ ACTIVITY BAR ============ */
.activity-bar {
  width: 28px; background: var(--bg-dark); border-right: 1px solid var(--border);
  display: flex; flex-direction: column; align-items: center;
  padding-top: 6px; gap: 2px; flex-shrink: 0;
}
.activity-btn {
  width: 24px; height: 24px; background: none; border: none;
  color: var(--text-dim); cursor: pointer; display: flex;
  align-items: center; justify-content: center; border-radius: 3px;
}
.activity-btn:hover { color: var(--text); }
.activity-btn.active { color: var(--text-bright); background: var(--bg-hover); }

/* ============ FILE EXPLORER ============ */
.file-explorer {
  width: 240px; background: var(--bg-dark); border-right: 1px solid var(--border);
  display: flex; flex-direction: column; flex-shrink: 0; overflow: hidden;
  min-width: 180px;
}
.explorer-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 12px; font-size: 11px; font-weight: 600;
  color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px;
}
.explorer-action {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; font-size: 14px; padding: 2px;
}
.explorer-action:hover { color: var(--text); }
.explorer-project {
  display: flex; align-items: center; gap: 6px;
  padding: 4px 12px; font-size: 13px; font-weight: 600;
  color: var(--text-bright); cursor: pointer;
}
.explorer-project:hover { background: var(--bg-hover); }
.project-icon { font-size: 10px; color: var(--text-dim); }
.file-tree {
  flex: 1; overflow-y: auto; padding: 4px 0;
}
.file-item {
  display: flex; align-items: center; gap: 6px;
  padding: 3px 12px 3px 20px; font-size: 13px;
  color: var(--text); cursor: pointer; white-space: nowrap;
}
.file-item:hover { background: var(--bg-hover); }
.file-item.active { background: var(--bg-active); color: #fff; }
.file-item.directory { color: var(--text-bright); }
.file-item .icon { font-size: 12px; width: 16px; text-align: center; flex-shrink: 0; }
.file-item .icon.folder { color: #dcb67a; }
.file-item .icon.file { color: var(--text-dim); }
.file-item .icon.js { color: #f7df1e; }
.file-item .icon.ts { color: #3178c6; }
.file-item .icon.json { color: #cbcb41; }
.file-item .icon.html { color: #e44d26; }
.file-item .icon.css { color: #264de4; }
.file-item .icon.md { color: #519aba; }
.file-item.nested { padding-left: 32px; }
.file-item.nested-2 { padding-left: 44px; }

/* Editor welcome screen */
.editor-welcome {
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  height: 100%; color: var(--text-dim); text-align: center; padding: 40px;
}
.editor-welcome h1 { font-size: 28px; color: var(--text); margin-bottom: 12px; font-weight: 300; }
.editor-welcome p { font-size: 14px; margin-bottom: 30px; }
.welcome-tips { display: flex; flex-direction: column; gap: 12px; max-width: 400px; }
.welcome-tips .tip {
  background: var(--bg-medium); padding: 12px 16px; border-radius: var(--radius);
  font-size: 13px; text-align: left; color: var(--text);
}
.welcome-tips .tip strong { color: var(--accent-light); }

/* ============ EDITOR AREA ============ */
.editor-area { flex: 1; display: flex; flex-direction: column; overflow: hidden; min-width: 0; }

/* Tab bar */
.tab-bar {
  display: flex; align-items: center;
  background: var(--bg-medium); border-bottom: 1px solid var(--border);
  flex-shrink: 0; overflow-x: auto;
}
.tab {
  display: flex; align-items: center; gap: 5px;
  padding: 5px 12px; font-size: 12px; cursor: pointer;
  border-right: 1px solid var(--border);
  color: var(--text-dim); background: var(--bg-medium); white-space: nowrap;
}
.tab:hover { color: var(--text); }
.tab.active {
  background: var(--bg-darkest); color: var(--text-bright);
  border-bottom: 2px solid var(--accent); margin-bottom: -1px;
}
.tab-icon { font-size: 8px; }
.tab-modified { color: #e8ab53; font-size: 10px; }
.tab-close {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; font-size: 14px; padding: 0 2px;
  border-radius: 2px; opacity: 0; transition: opacity 0.15s;
}
.tab:hover .tab-close { opacity: 1; }
.tab-close:hover { background: rgba(255,255,255,0.1); color: var(--text); }
.tab-overflow, .tab-settings {
  padding: 5px 8px; color: var(--text-dim); cursor: pointer; font-size: 14px;
}
.tab-overflow:hover, .tab-settings:hover { color: var(--text); }
.tab-settings { margin-left: auto; }

.cs-icon { background: #68217a; color: #fff; font-size: 8px; font-weight: 700; padding: 1px 3px; border-radius: 2px; }
.razor-icon { color: #42b883; font-size: 9px; font-weight: 700; }
.json-icon { color: #f1e05a; font-size: 9px; font-weight: 700; }
.css-icon { color: #56b6c2; font-size: 8px; font-weight: 700; }

/* Breadcrumb */
.breadcrumb {
  display: flex; align-items: center; justify-content: space-between;
  padding: 2px 8px; font-size: 12px; color: var(--text-dim);
  background: var(--bg-darkest); border-bottom: 1px solid var(--border); flex-shrink: 0;
}
.breadcrumb-left { display: flex; align-items: center; gap: 4px; }
.breadcrumb-select {
  background: none; border: none; color: var(--text-dim);
  font-size: 12px; font-family: var(--font-ui); cursor: pointer;
  padding: 2px 4px; border-radius: var(--radius);
}
.breadcrumb-select:hover { background: var(--bg-hover); color: var(--text); }
.breadcrumb-icon {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; padding: 2px 6px; font-size: 14px;
}

/* Code container */
.code-container { flex: 1; display: flex; overflow: auto; background: var(--bg-darkest); }
.gutter {
  width: 50px; background: var(--bg-darkest); text-align: right;
  padding: 4px 8px 4px 0; color: var(--text-dimmer);
  font-family: var(--font-code); font-size: 13px; line-height: 20px;
  flex-shrink: 0; user-select: none;
}
.code-content {
  flex: 1; padding: 4px 0 4px 8px;
  font-family: var(--font-code); font-size: 13px; line-height: 20px;
  overflow: auto; white-space: nowrap;
}
.code-line { min-height: 20px; padding: 0 16px 0 0; }

/* Syntax */
.kw { color: var(--blue); }
.type { color: var(--green); }
.method { color: var(--yellow); }
.field { color: var(--light-blue); }
.param { color: var(--light-blue); }
.str { color: var(--string-color); }
.num { color: #b5cea8; }
.comment { color: var(--comment-green); font-style: italic; }
.ns { color: var(--green); }
.directive { color: var(--directive-color); }
.attr { color: var(--attr-color); }

/* ============ BOTTOM PANEL ============ */
.bottom-panel {
  height: 120px; background: var(--bg-dark);
  border-top: 1px solid var(--border);
  display: flex; flex-direction: column; flex-shrink: 0;
  min-height: 60px; max-height: 60vh;
  position: relative;
}
.bottom-panel.expanded { height: 45vh; }
.bottom-panel-resize {
  position: absolute; top: -4px; left: 0; right: 0; height: 8px;
  cursor: ns-resize; z-index: 10;
}
.bottom-panel-resize:hover { background: rgba(0,120,212,0.4); }
.bottom-tabs { display: flex; border-bottom: 1px solid var(--border); }
.expand-btn {
  margin-left: auto; padding: 0 10px; background: none; border: none;
  color: var(--text-muted); cursor: pointer; font-size: 16px;
}
.expand-btn:hover { color: var(--text); }
.bottom-tab {
  background: none; border: none; color: var(--text-dim);
  padding: 4px 14px; cursor: pointer; font-family: var(--font-ui);
  font-size: 12px; border-bottom: 2px solid transparent;
}
.bottom-tab:hover { color: var(--text); }
.bottom-tab.active { color: var(--text-bright); border-bottom-color: var(--accent); }
.bottom-content { flex: 1; padding: 0; overflow: hidden; display: flex; flex-direction: column; }
.panel-content { flex: 1; overflow-y: auto; padding: 8px 12px; }
#outputLog {
  margin: 0; font-family: Consolas, monospace; font-size: 12px;
  color: #ccc; white-space: pre-wrap; word-wrap: break-word;
}
/* Visible scrollbar for output panel */
.panel-content::-webkit-scrollbar { width: 10px; }
.panel-content::-webkit-scrollbar-track { background: #1e1e1e; }
.panel-content::-webkit-scrollbar-thumb { background: #555; border-radius: 5px; }
.panel-content::-webkit-scrollbar-thumb:hover { background: #777; }
.no-issues { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--green); }
.severity-ok { color: var(--green); }

/* ============ CHAT PANEL ============ */
.chat-panel {
  width: 340px; background: var(--bg-darkest);
  border-left: 1px solid var(--border);
  display: flex; flex-direction: column; flex-shrink: 0;
  min-width: 280px;
}
.chat-panel.hidden { width: 0; overflow: hidden; border-left: none; }

/* Chat panel title bar */
.chat-panel-titlebar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 6px 10px; border-bottom: 1px solid var(--border);
  background: var(--bg-dark); flex-shrink: 0;
}
.chat-panel-title { font-size: 12px; font-weight: 600; color: var(--text-bright); }
.chat-panel-controls { display: flex; gap: 2px; }
.panel-ctrl-btn {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; padding: 2px 6px; border-radius: var(--radius); font-size: 13px;
}
.panel-ctrl-btn:hover { background: var(--bg-hover); color: var(--text); }

/* Thread bar */
.thread-bar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 6px 10px; border-bottom: 1px solid var(--border); flex-shrink: 0;
  position: relative;
}
.thread-select {
  display: flex; align-items: center; gap: 6px;
  background: var(--bg-light); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 4px 10px;
  font-size: 12px; color: var(--text); cursor: pointer; flex: 1;
  margin-right: 8px;
}
.thread-select:hover { border-color: var(--border-light); }
.thread-chevron { margin-left: auto; font-size: 10px; color: var(--text-dim); }
.thread-actions { display: flex; gap: 2px; }
.thread-action-btn {
  background: none; border: 1px solid transparent; color: var(--text-dim);
  cursor: pointer; padding: 4px 6px; border-radius: var(--radius); display: flex;
  align-items: center; justify-content: center;
}
.thread-action-btn:hover { background: var(--bg-hover); color: var(--text); }
.active-thread-btn { border-color: var(--accent); background: var(--bg-selected); color: var(--text); }

/* PR Threads View */
.pr-threads-view { flex: 1; overflow-y: auto; }
.pr-thread-item {
  display: flex; align-items: flex-start; gap: 10px;
  padding: 12px 14px; border-bottom: 1px solid var(--border); cursor: pointer;
}
.pr-thread-item:hover { background: var(--bg-hover); }
.pr-thread-icon { flex-shrink: 0; margin-top: 2px; }
.pr-thread-content { flex: 1; min-width: 0; }
.pr-thread-title { font-size: 13px; color: var(--text-bright); line-height: 1.4; }
.pr-thread-link {
  font-size: 12px; color: var(--accent-light); cursor: pointer;
  text-decoration: none; margin-top: 2px; display: inline-block;
}
.pr-thread-link:hover { text-decoration: underline; }
.pr-thread-status { font-size: 12px; color: var(--text-dim); white-space: nowrap; flex-shrink: 0; }

/* Chat View */
.chat-view { display: flex; flex-direction: column; flex: 1; overflow: hidden; }
.chat-messages { flex: 1; overflow-y: auto; padding: 12px; display: flex; flex-direction: column; gap: 12px; }

/* Welcome screen */
.welcome-screen {
  display: flex; flex-direction: column; align-items: center;
  justify-content: center; flex: 1; padding: 40px 20px; text-align: center;
}
.welcome-icon { margin-bottom: 16px; opacity: 0.7; }
.welcome-title { font-size: 22px; font-weight: 600; color: var(--text-bright); margin-bottom: 6px; }
.welcome-subtitle { font-size: 13px; color: var(--text-dim); margin-bottom: 28px; }
.welcome-actions { display: flex; flex-direction: column; gap: 8px; width: 100%; max-width: 280px; }
.welcome-action-btn {
  display: flex; align-items: center; gap: 10px;
  background: var(--bg-light); border: 1px solid var(--border);
  color: var(--text); padding: 10px 16px;
  border-radius: var(--radius-lg); cursor: pointer;
  font-family: var(--font-ui); font-size: 13px; text-align: left;
  transition: background 0.15s, border-color 0.15s;
}
.welcome-action-btn:hover {
  background: var(--bg-hover); border-color: var(--border-light);
}

/* Chat messages */
.chat-msg { display: flex; gap: 10px; }
.msg-avatar {
  width: 28px; height: 28px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center; flex-shrink: 0;
}
.copilot-avatar { background: var(--bg-medium); border: 1px solid var(--border); }
.user-avatar { background: var(--accent); color: #fff; font-size: 10px; font-weight: 600; }
.msg-body { flex: 1; min-width: 0; }
.msg-name { font-size: 12px; font-weight: 600; color: var(--text-bright); margin-bottom: 4px; }
.msg-text { font-size: 13px; line-height: 1.5; color: var(--text); }
.msg-text p { margin: 6px 0; }
.msg-text code {
  background: var(--bg-light); padding: 1px 5px; border-radius: 3px;
  font-family: var(--font-code); font-size: 12px; color: var(--orange);
}
.msg-actions { display: flex; gap: 4px; margin-top: 8px; }
.msg-action-btn {
  background: var(--bg-light); border: 1px solid var(--border);
  color: var(--text-dim); padding: 3px 8px; border-radius: var(--radius);
  cursor: pointer; font-size: 12px;
}
.msg-action-btn:hover { background: var(--bg-hover); color: var(--text); }

/* Code block in chat */
.code-block { margin: 8px 0; border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
.code-block-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 6px 10px; background: var(--bg-medium); font-size: 11px;
  color: var(--text-dim); border-bottom: 1px solid var(--border);
}
.code-block pre {
  padding: 10px; background: var(--bg-darkest); overflow-x: auto;
  font-family: var(--font-code); font-size: 12px; line-height: 1.5;
}

/* ============ CHAT INPUT AREA ============ */
.chat-input-area {
  border-top: 1px solid var(--border); padding: 8px 10px; flex-shrink: 0;
  position: relative;
}

/* Slash command menu */
.slash-menu {
  display: none; position: absolute; bottom: 100%; left: 10px; right: 10px;
  background: var(--bg-medium); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 4px;
  box-shadow: 0 6px 24px rgba(0,0,0,0.4); z-index: 100;
  max-height: 320px; overflow-y: auto;
}
.slash-menu.visible { display: block; }
.slash-row {
  display: flex; align-items: center; justify-content: space-between;
  padding: 7px 14px; cursor: pointer; font-size: 13px;
}
.slash-row:hover { background: var(--bg-active); color: #fff; }
.slash-cmd { color: var(--text-bright); font-weight: 500; }
.slash-desc { color: var(--text-dim); font-size: 12px; text-align: right; }
.slash-row:hover .slash-desc { color: rgba(255,255,255,0.7); }

/* Thread dropdown */
.thread-dropdown {
  position: absolute; top: 100%; left: 0; margin-top: 4px;
  width: 320px; background: var(--bg-medium); border: 1px solid var(--border);
  border-radius: var(--radius-lg); box-shadow: 0 6px 24px rgba(0,0,0,0.4);
  z-index: 200; overflow: hidden;
}
.thread-dropdown-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 14px; border-bottom: 1px solid var(--border);
  font-size: 12px; font-weight: 600; color: var(--text-dim);
}
.new-thread-btn {
  background: var(--accent); color: #fff; border: none;
  padding: 4px 10px; border-radius: var(--radius); font-size: 11px;
  cursor: pointer; font-weight: 600;
}
.new-thread-btn:hover { background: var(--accent-light); }
.thread-dropdown-list {
  max-height: 300px; overflow-y: auto;
}
.thread-dropdown-item {
  display: flex; align-items: center; gap: 8px;
  padding: 10px 14px; cursor: pointer; font-size: 13px;
  border-bottom: 1px solid var(--border);
}
.thread-dropdown-item:last-child { border-bottom: none; }
.thread-dropdown-item:hover { background: var(--bg-hover); }
.thread-dropdown-item.active { background: var(--bg-active); }
.thread-item-title {
  flex: 1; color: var(--text); white-space: nowrap;
  overflow: hidden; text-overflow: ellipsis;
}
.thread-dropdown-item.active .thread-item-title { color: #fff; }
.thread-item-date { color: var(--text-dim); font-size: 11px; flex-shrink: 0; }
.thread-delete-btn {
  background: none; border: none; color: var(--text-dim);
  font-size: 16px; cursor: pointer; padding: 0 4px;
  line-height: 1; opacity: 0; transition: opacity 0.15s;
}
.thread-dropdown-item:hover .thread-delete-btn { opacity: 1; }
.thread-delete-btn:hover { color: var(--red); }

/* Agent mode popup */
.agent-mode-popup {
  display: none; position: absolute; bottom: 100%; left: 10px;
  width: 420px; background: var(--bg-medium); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 4px;
  box-shadow: 0 6px 24px rgba(0,0,0,0.4); z-index: 100;
  padding: 4px 0;
}
.agent-mode-popup.visible { display: block; }
.agent-mode-item {
  display: flex; align-items: flex-start; gap: 10px;
  padding: 8px 14px; cursor: pointer;
}
.agent-mode-item:hover { background: var(--bg-hover); }
.agent-mode-item.active { background: var(--bg-active); }
.agent-mode-item svg { flex-shrink: 0; margin-top: 2px; }
.agent-mode-info { flex: 1; }
.agent-mode-name { font-size: 13px; font-weight: 600; color: var(--text-bright); }
.agent-mode-desc { font-size: 12px; color: var(--text-dim); margin-top: 1px; line-height: 1.4; }
.agent-mode-item.active .agent-mode-desc { color: rgba(255,255,255,0.6); }

/* Model popup */
.model-popup {
  display: none; position: absolute; bottom: 100%; right: 10px;
  width: 280px; background: var(--bg-medium); border: 1px solid var(--border);
  border-radius: var(--radius-lg); margin-bottom: 4px;
  box-shadow: 0 6px 24px rgba(0,0,0,0.4); z-index: 100;
  padding: 4px 0; max-height: 400px; overflow-y: auto;
}
.model-popup.visible { display: block; }
.model-section-title {
  font-size: 11px; font-weight: 600; color: var(--text-dim);
  padding: 8px 14px 4px; text-transform: none;
}
.model-item {
  display: flex; align-items: center; justify-content: space-between;
  padding: 6px 14px; cursor: pointer; font-size: 13px;
}
.model-item:hover { background: var(--bg-hover); }
.model-item.active { background: var(--bg-active); }
.model-name { color: var(--text); }
.model-item.active .model-name { color: #fff; }
.model-rate { color: var(--text-dim); font-size: 12px; }
.model-item.active .model-rate { color: rgba(255,255,255,0.6); }
.preview-warning { color: #e8ab53; font-size: 11px; margin-right: 2px; }

/* Chat hint */
.chat-hint {
  display: none; text-align: center; padding: 8px 0 4px;
  font-size: 12px; color: var(--text-dimmer);
}
.chat-hint.visible { display: block; }
.hint-key { color: var(--accent-light); }

/* Input wrapper */
.input-wrapper {
  display: flex; align-items: center;
  background: var(--bg-lighter); border: 1px solid var(--border);
  border-radius: var(--radius-lg); overflow: hidden;
  transition: border-color 0.15s;
}
.input-wrapper:focus-within { border-color: var(--accent); }
.add-context-btn {
  background: none; border: none; color: #2ea043;
  cursor: pointer; padding: 6px 10px; font-size: 18px; font-weight: 600;
}
.add-context-btn:hover { color: #3ddb58; }
.chat-input {
  flex: 1; background: none; border: none; color: var(--text);
  font-family: var(--font-ui); font-size: 13px; padding: 8px 4px; outline: none;
}
.chat-input::placeholder { color: var(--text-dim); }

/* Bottom bar */
.chat-bottom-bar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 6px 0 0;
}
.chat-bottom-left { display: flex; align-items: center; gap: 8px; }
.chat-bottom-right { display: flex; align-items: center; gap: 4px; }

.agent-selector, .model-selector {
  display: flex; align-items: center; gap: 5px;
  background: none; border: none; color: var(--text);
  cursor: pointer; font-family: var(--font-ui); font-size: 12px; padding: 3px 6px;
  border-radius: var(--radius);
}
.agent-selector:hover, .model-selector:hover { background: var(--bg-hover); }
.selector-chevron { font-size: 10px; color: var(--text-dim); }

.chat-action-icon {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; padding: 4px 6px; border-radius: var(--radius);
  display: flex; align-items: center; justify-content: center;
}
.chat-action-icon:hover { background: var(--bg-hover); color: var(--text); }
.send-btn {
  background: none; border: none; color: var(--text-dim);
  cursor: pointer; padding: 4px 8px; border-radius: var(--radius);
  display: flex; align-items: center; justify-content: center;
}
.send-btn:hover { color: var(--text); background: var(--bg-hover); }

/* ============ STATUS BAR ============ */
.statusbar {
  display: flex; align-items: center; justify-content: space-between;
  height: 22px; background: #68217a; padding: 0 10px;
  flex-shrink: 0; font-size: 11px; color: #fff;
}
.status-left, .status-right { display: flex; align-items: center; gap: 10px; }
.status-center { flex: 1; display: flex; justify-content: center; }
.status-scrollbar { width: 300px; height: 3px; background: rgba(255,255,255,0.15); border-radius: 2px; }
.status-item {
  display: flex; align-items: center; gap: 3px;
  cursor: pointer; padding: 0 4px; height: 22px;
}
.status-item:hover { background: rgba(255,255,255,0.12); }
.ok-status { color: #7dffb3; }
.status-sep { width: 1px; height: 14px; background: rgba(255,255,255,0.2); }
.branch-status { display: flex; align-items: center; gap: 3px; }

/* ============ ANIMATIONS ============ */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}
.chat-msg { animation: fadeIn 0.25s ease-out; }

.streaming-cursor {
  display: inline-block; width: 8px; height: 15px;
  background: var(--accent); animation: blink 1s step-end infinite;
  vertical-align: text-bottom; margin-left: 2px;
}
@keyframes blink { 50% { opacity: 0; } }

/* Tool indicators in chat */
.tool-indicator {
  display: flex; align-items: center; gap: 8px;
  padding: 8px 12px; margin: 6px 0;
  background: var(--bg-medium); border-left: 3px solid var(--accent);
  border-radius: 0 var(--radius) var(--radius) 0;
  font-size: 12px; color: var(--text-dim);
  animation: fadeIn 0.2s ease-out;
}
.tool-indicator .tool-icon { font-size: 14px; }
.tool-indicator.tool-success { border-left-color: var(--green); color: var(--green); }
.tool-indicator.tool-error { border-left-color: var(--red); color: var(--red); }

/* Thinking dots */
.thinking-dots { display: flex; gap: 4px; padding: 8px 0; }
.thinking-dots .dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--accent-light); animation: dotPulse 1.4s ease-in-out infinite;
}
.thinking-dots .dot:nth-child(2) { animation-delay: 0.2s; }
.thinking-dots .dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes dotPulse {
  0%, 80%, 100% { opacity: 0.3; transform: scale(0.8); }
  40% { opacity: 1; transform: scale(1); }
}

/* ============ AUTH OVERLAY ============ */
.auth-overlay {
  position: fixed; inset: 0; z-index: 2000;
  background: rgba(0,0,0,0.8); display: flex;
  align-items: center; justify-content: center;
}
.auth-modal {
  background: var(--bg-medium); border: 1px solid var(--border);
  border-radius: 12px; padding: 40px; max-width: 500px;
  text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}
.auth-icon { margin-bottom: 20px; }
.auth-modal h2 { margin: 0 0 12px; color: #fff; font-size: 22px; font-weight: 600; }
.auth-modal p { margin: 0 0 20px; color: var(--text-dim); font-size: 14px; }
.auth-steps {
  background: var(--bg-dark); border-radius: 8px; padding: 16px;
  text-align: left; margin-bottom: 24px;
}
.auth-step {
  padding: 8px 0; color: var(--text); font-size: 13px;
  font-family: var(--font-code); border-bottom: 1px solid var(--border);
}
.auth-step:last-child { border-bottom: none; }
.auth-actions { display: flex; gap: 12px; justify-content: center; margin-bottom: 16px; }
.auth-btn {
  padding: 10px 24px; border-radius: 6px; font-size: 14px;
  font-weight: 600; cursor: pointer; border: none;
}
.auth-btn.primary { background: var(--accent); color: #fff; }
.auth-btn.primary:hover { background: var(--accent-light); }
.auth-btn.secondary { background: var(--bg-hover); color: var(--text); }
.auth-btn.secondary:hover { background: var(--bg-light); }
.auth-note { font-size: 12px; color: var(--text-dimmer); margin: 0; }

/* Device Flow specific styles */
.device-code {
  font-family: var(--font-code);
  font-size: 32px;
  font-weight: 700;
  letter-spacing: 4px;
  color: #fff;
  background: var(--bg-dark);
  border: 2px solid var(--accent);
  border-radius: 8px;
  padding: 16px 24px;
  margin: 20px 0;
  cursor: pointer;
  user-select: all;
  transition: all 0.2s ease;
}
.device-code:hover {
  background: var(--bg-hover);
  border-color: var(--accent-light);
}
.device-code.copied {
  border-color: #2ea043;
  background: rgba(46, 160, 67, 0.1);
}
.device-code.copied::after {
  content: ' (Copied!)';
  font-size: 12px;
  color: #2ea043;
  letter-spacing: 0;
}

.verification-link {
  color: var(--accent);
  text-decoration: none;
  font-weight: 600;
}
.verification-link:hover {
  text-decoration: underline;
}

.auth-polling {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 16px;
  color: var(--text-dim);
  font-size: 14px;
}

.auth-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.auth-spinner-small {
  width: 16px;
  height: 16px;
  border: 2px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* User avatar and menu */
.user-avatar-circle {
  cursor: pointer;
  transition: opacity 0.2s;
}
.user-avatar-circle:hover {
  opacity: 0.8;
}
.user-avatar-circle.authenticated {
  background: var(--accent);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.user-initial {
  color: #fff;
  font-size: 12px;
  font-weight: 600;
}

.user-menu {
  position: fixed;
  background: var(--bg-medium);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  z-index: 3000;
  min-width: 180px;
  overflow: hidden;
}
.user-menu-header {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-dark);
  color: #fff;
  font-size: 13px;
  font-weight: 600;
}
.user-menu-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 16px;
  color: var(--text);
  font-size: 13px;
  cursor: pointer;
  transition: background 0.15s;
}
.user-menu-item:hover {
  background: var(--bg-hover);
  color: #fff;
}
.user-menu-item svg {
  opacity: 0.7;
}
.user-menu-item:hover svg {
  opacity: 1;
}

/* ============ FEATURE AUDIT PANEL ============ */
/* Status bar button */
.audit-status-btn {
  display: flex; align-items: center; gap: 4px;
  background: none; border: none; color: var(--text);
  font-size: 11px; cursor: pointer; padding: 2px 8px;
  border-radius: 3px; transition: background 0.15s;
}
.audit-status-btn:hover { background: var(--bg-hover); color: var(--text-bright); }
.audit-status-btn svg { opacity: 0.7; }
.audit-status-btn:hover svg { opacity: 1; }

/* Panel modal */
.audit-panel {
  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
  width: 700px; max-height: 85vh; background: #1e1e1e;
  border: 1px solid #444; border-radius: 8px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  z-index: 1001; display: none; flex-direction: column;
  font-family: var(--font-ui);
}
.audit-panel.visible { display: flex; }

.audit-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 14px 20px; border-bottom: 1px solid #333; background: #252526;
}
.audit-header h3 { margin: 0; color: #fff; font-size: 15px; font-weight: 600; }
.audit-close {
  background: none; border: none; color: #888; font-size: 20px;
  cursor: pointer; line-height: 1; padding: 4px 8px; border-radius: 4px;
}
.audit-close:hover { color: #fff; background: #3c3c3c; }

.audit-legend {
  display: flex; gap: 20px; padding: 10px 20px;
  background: #1e1e1e; border-bottom: 1px solid #333;
}
.legend-item { display: flex; align-items: center; gap: 6px; font-size: 11px; color: #aaa; }
.legend-item .dot { width: 8px; height: 8px; border-radius: 50%; }
.legend-item .dot.connected { background: #2ea043; } /* Green = working */
.legend-item .dot.ui-only { background: #f0883e; }   /* Orange = easy wiring */
.legend-item .dot.sdk-only { background: #58a6ff; }  /* Blue = needs GUI work */

.audit-stats {
  display: flex; gap: 16px; padding: 10px 20px;
  background: #252526; border-bottom: 1px solid #333;
}
.audit-stats .stat {
  font-size: 12px; color: #888;
}
.audit-stats .stat strong {
  font-weight: 600; margin-right: 4px;
}
.audit-stats .stat:nth-child(1) strong { color: #2ea043; }
.audit-stats .stat:nth-child(2) strong { color: #f0883e; }
.audit-stats .stat:nth-child(3) strong { color: #58a6ff; }

.audit-content {
  flex: 1; overflow-y: auto; padding: 16px 20px;
}
.audit-content::-webkit-scrollbar { width: 8px; }
.audit-content::-webkit-scrollbar-track { background: #1e1e1e; }
.audit-content::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }

.audit-section { margin-bottom: 20px; }
.audit-section h4 {
  margin: 0 0 6px 0; color: #888; font-size: 11px;
  text-transform: uppercase; letter-spacing: 0.8px; font-weight: 600;
}
.audit-note {
  margin: 0 0 8px 0; font-size: 11px; color: #666;
  font-style: italic;
}

.audit-item {
  display: flex; align-items: center; gap: 10px;
  padding: 6px 10px; margin-bottom: 2px;
  background: #252526; border-radius: 4px; font-size: 12px;
}
.audit-item .status-dot {
  width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0;
}
.audit-item.connected .status-dot { background: #2ea043; }
.audit-item.ui-only .status-dot { background: #f0883e; }
.audit-item.sdk-only .status-dot { background: #58a6ff; }

.audit-item .feature-name { flex: 1; color: #e0e0e0; }
.audit-item .feature-status { color: #666; font-size: 10px; text-align: right; max-width: 240px; }

.audit-item.connected .feature-status { color: #2ea043; }
.audit-item.ui-only .feature-status { color: #f0883e; }
.audit-item.sdk-only .feature-status { color: #58a6ff; }

/* Highlight mode when audit is active */
body.audit-mode .chat-input-area,
body.audit-mode .send-btn { outline: 2px solid #2ea043; outline-offset: 2px; }
body.audit-mode .agent-selector,
body.audit-mode .model-selector,
body.audit-mode .slash-menu,
body.audit-mode .thread-select,
body.audit-mode .add-context-btn { outline: 2px dashed #f0883e; outline-offset: 2px; }
body.audit-mode .chat-action-icon { outline: 2px dashed #f0883e; outline-offset: 1px; }
